- content_for :title, @product.name
- content_for :meta_tags do
  = meta_tags(title: @product.name,
              type: 'product',
              image: object_image(@product),
              description: @product.description,
              amount: @product.price)

%section#product
  .container
    = breadcrumb_nav(product: @product)
    .row
      .col-sm-12.navigation
        .back &lt;
        = link_to 'Back to search', 'javascript:history.back();'
    .row
      .col-sm-5
        = image_tag @product.primary_image.url(:medium),
          alt: @product.name, id: 'primary-image', class: 'img-fluid'
        .images-container
          - @product.images.each do |image|
            = image_tag image.url(:medium)
      .col-sm-7.clear{class: @product.free ? 'free' : ''}
        %h1.name
          = @product.name
        .price-container
          %h4.price
            = "$#{@product.price}"
          - if @product.free
            .free-label
              free
        .social
          = facebook_like
          = pin_it(image: object_image(@product),
                   description: @product.description)
          = tweet(text: @product.name)
        %h5.section-title
          Description
        .section
          = @product.description.html_safe

        - if @product.free
          .add-to-cart
            - if user_signed_in?
              = link_to 'Download', @product.download_url,
                class: 'btn btn-cart'
            - else
              Please
              = link_to 'sign in', new_user_session_path
              or
              = link_to 'register', new_registration_path('user')
              to download
        - else
          - if is_in_cart?(@order, @product)
            This product is already in
            = succeed "." do
              = link_to 'your cart', order_url(@order),
                data: { turbolinks: false }
          - else
            - if @shipping_cost
              Shipping: #{ number_to_currency(@shipping_cost.price_cents / 100.0) }
              %br
              %br
            - elsif @product.fulfill_via_shipment?
              = link_to 'Calculate Shipping',
                shipping_product_path(@product)
              %br
              %br
            = add_to_cart(@product, @shipping_cost.try(:price_cents))

- content_for :tracking do
  :javascript
    if (typeof fbq !== 'undefined') {
      fbq('track', 'ViewContent', {
        content_name: '#{@product.name}',
        content_category: '#{@product.topic_name}',
        value: #{(@product.price * Constants::VIEW_CONTENT_WEIGHT).round(2)},
        currency: 'USD',
        referrer: document.referrer,
        userAgent: navigator.userAgent,
        language: navigator.language
      });
    }
